{"name":"CakePHP Paypal REST Client","tagline":"A CakePHP 2.x plugin REST client for Paypal's API","body":"#CakePHP Paypal REST Client (PaypalSource)\r\n### Introduction\r\nThis plugin is a full REST client for Paypal's API. It implements all of the functions available through the Paypal REST API.  \r\n\r\nInstead of using CURL, CakePHP's HTTPSocket class is used.\r\n\r\n#### Disclaimer\r\n*Alpha Version... Probably a good idea not to use this in production yet...*\r\n\r\n\r\n### Documentation: Table of Contents\r\n1. [Installation](#installation)\r\n2. [Configuration](#configuration)\r\n3. [Usage](#usage)\r\n\t- [Including the Paypal Model in your controller](#including-the-paypal-model-in-your-controller) \r\n\t- [Notes about response returned](#notes-about-response-returned)\r\n\t- [Credit Card Payment](#credit-card-payment)\r\n\t- [Capture an Authorization](#capture-an-authorization)\r\n\t- [Void an Authorization](#void-an-authorization)\r\n\t- [Refund a sale](#refund-a-sale)\r\n\r\n#### Installation\r\n\r\n1) Clone the repository into the `app/Plugins/PaypalSource` directory  \r\n\r\n```\r\ncd app/Plugins  \r\ngit clone https://github.com/jlkaufman/cakephp-paypal-rest-client.git PaypalSource\r\n```\r\n2) Install with *composer*  \r\n\r\n```\r\nrequire\": {\r\n    \"jlkaufman/cakephp-paypal-rest-client\": \"0.1-alpha\"\r\n}\r\n```\r\n#### Configuration\r\n\r\nIn `database.php` add the following block and fill it out accordingly:\r\n\r\n```\r\n// Paypal\r\n\tpublic $Paypal = array(\r\n\t\t'datasource'     => 'PaypalSource.PaypalSource',\r\n\t\t'environment'    => 'sandbox', // Production: 'production'   SandBox: 'sandbox'\r\n\t\t'username'       => '',\r\n\t\t'password'       => '',\r\n\t\t'receiver_email' => ''\r\n\t);\r\n```\r\n\r\n### Usage\r\n\r\n#### Including the Paypal Model in your controller\r\n* Add `PaypalSource.Paypal` to your $uses array.  \r\n\t*E.g.:* `public $uses = array('PaypalSource.Paypal');`  \r\n\t\r\n\tYou can now call the model with `$this->Paypal->method();` from your controller.  \r\n\t\r\n#### Notes about response returned\r\nAll the methods in the Paypal class will return an instance of StdClass. In the documentation we show the object in JSON form, simply for readability. You can access each member of the object using arrow notation. \r\n\r\n#### Credit Card Payment\r\n\r\nCredit card payments are easy to create. We can do one of two things; we can create a sale (a final payment), or we can authorize an amount that we will capture later.\r\n\r\n* $data will contain all the information we're going to send to Paypal\r\n\r\nCredit Card:\t\r\n\r\n```\r\n$data = array(\r\n\t'credit_card' => array(\r\n\t\t\"number\"       => \"4417119669820331\",\r\n\t\t\"type\"         => \"visa\",\r\n\t\t\"expire_month\" => 1,\r\n\t\t\"expire_year\"  => 2018,\r\n\t\t\"cvv2\"         => \"874\",\r\n\t\t\"first_name\"   => \"Joe\",\r\n\t\t\"last_name\"    => \"Shopper\"\r\n\t),\r\n\t'billing_address' => array(\r\n\t\t\"line1\"        => \"52 N Main ST\",\r\n\t\t\"line2\"        => \"Apt. 211\",\r\n\t\t\"city\"         => \"Johnstown\",\r\n\t\t\"country_code\" => \"CA\",\r\n\t\t\"postal_code\"  => \"H0H 0H0\",\r\n\t\t\"state\"        => \"Quebec\"\r\n\t),\r\n\t'transaction' => array(\r\n\t\t\"amount\" => array(\r\n\t\t\t\"total\"    => \"7.47\",\r\n\t\t\t\"currency\" => \"USD\",\r\n\t\t\t\"details\"  => array(\r\n\t\t\t\t\"subtotal\" => \"7.41\",\r\n\t\t\t\t\"tax\"      => \"0.03\",\r\n\t\t\t\t\"shipping\" => \"0.03\"\r\n\t\t\t)\r\n\t\t),\r\n\t\t\"description\" => \"This is the payment transaction description.\"\r\n\t)\r\n);\r\n\r\n$response = $this->Paypal->creditCardPayment($data, $type);\r\n\t\r\n```\t\r\nCredit Card Token:\r\n\r\n```\r\n$data = array(\r\n\t'credit_card_token' => array(\r\n\t\t\"credit_card_id\" => \"CARD-7VH15004HC811510SKEGDHDI\"\r\n\t),\r\n\t'transaction' => array(\r\n\t\t\"amount\" => array(\r\n\t\t\t\"total\"    => \"7.47\",\r\n\t\t\t\"currency\" => \"USD\",\r\n\t\t\t\"details\"  => array(\r\n\t\t\t\t\"subtotal\" => \"7.41\",\r\n\t\t\t\t\"tax\"      => \"0.03\",\r\n\t\t\t\t\"shipping\" => \"0.03\"\r\n\t\t\t)\r\n\t\t),\r\n\t\t\"description\" => \"This is the payment transaction description.\"\r\n\t)\r\n);\r\n\r\n$response = $this->Paypal->creditCardPayment($data, $type);             \r\n```\r\n* $type can either be `authorization` or `sale`  \r\n\t`sale`: A final sale, and will complete the transaction  \r\n\t`authorization`: Authorize the card for the amount specified. We will have to capture the payment later.\r\n\r\n##### Example response\r\n\r\n```\r\n{\r\n   \"id\": \"PAY-30J08441N2038343CKLJHKEA\",\r\n   \"status\": \"approved\",\r\n   \"created\": \"2014-01-12 10:57:20\",\r\n   \"modified\": \"2014-01-12 10:57:29\",\r\n   \"payment_method\": \"credit_card\",\r\n   \"type\": \"authorize\",\r\n   \"payer\": {\r\n      \"billing_address\": {\r\n         \"line1\": \"52 N Main ST\",\r\n         \"line2\": \"Apt. 211\",\r\n         \"city\": \"Johnstown\",\r\n         \"state\": \"Quebec\",\r\n         \"postal_code\": \"H0H 0H0\",\r\n         \"country_code\": \"CA\"\r\n      },\r\n      \"credit_card\": {\r\n         \"type\": \"visa\",\r\n         \"number\": \"xxxxxxxxxxxx0331\",\r\n         \"expire_month\": \"1\",\r\n         \"expire_year\": \"2018\",\r\n         \"first_name\": \"Joe\",\r\n         \"last_name\": \"Shopper\"\r\n      },\r\n      \"id\": \"\",\r\n      \"email\": \"\"\r\n   },\r\n   \"approval_url\": \"\",\r\n   \"transaction\": {\r\n      \"amount\": {\r\n         \"total\": \"7.47\",\r\n         \"currency\": \"USD\",\r\n         \"details\": {\r\n            \"subtotal\": \"7.41\",\r\n            \"tax\": \"0.03\",\r\n            \"shipping\": \"0.03\"\r\n         }\r\n      },\r\n      \"description\": \"This is the payment transaction description.\",\r\n      \"sale\": {\r\n         \"id\": \"\",\r\n         \"parent_id\": \"\"\r\n      },\r\n      \"authorization\": {\r\n         \"id\": \"10V50318J8770814T\",\r\n         \"created\": \"2014-01-12 10:57:20\",\r\n         \"parent_id\": \"PAY-30J08441N2038343CKLJHKEA\"\r\n      }\r\n   },\r\n   \"error\": {\r\n      \"code\": false\r\n   }\r\n}\r\n```\r\n\r\n#### Capture an Authorization\r\nTo capture an authorization one must create the [Authorization](#credit-card-payment) (Credit Card Payment with $type set to `authorization`) and get the Authorization ID from the response.\r\n\r\nHere's an example of capturing an authorization:\r\n\r\n```\r\n$capture_data = array(\r\n\t'authorization_id' => '10V50318J8770814T',\r\n\t'currency'         => 'USD',\r\n\t'total'            => '7.47',\r\n\t'is_final_capture' => true\r\n);\r\n\r\n$response = $this->Paypal->captureAuthorization($data);\r\n```\r\n* `authorization_id` is stored in the response object returned by `Paypal::creditCardPayment()` in `$response->transaction->authorization->id`\r\n\r\n##### Example Capture Response\r\n\r\n```\r\n{\r\n   \"id\": \"2E448764JU789501Y\",\r\n   \"status\": \"completed\",\r\n   \"created\": \"2014-01-12 10:57:30\",\r\n   \"modified\": \"2014-01-12 10:57:42\",\r\n   \"payment_method\": null,\r\n   \"type\": \"capture\",\r\n   \"payer\": {\r\n      \"billing_address\": {\r\n         \"line1\": \"\",\r\n         \"line2\": \"\",\r\n         \"city\": \"\",\r\n         \"country_code\": \"\",\r\n         \"postal_code\": \"\",\r\n         \"state\": \"\"\r\n      },\r\n      \"credit_card\": {\r\n         \"number\": \"\",\r\n         \"type\": \"\",\r\n         \"expire_month\": \"\",\r\n         \"expire_year\": \"\",\r\n         \"first_name\": \"\",\r\n         \"last_name\": \"\"\r\n      },\r\n      \"id\": \"\",\r\n      \"email\": \"\"\r\n   },\r\n   \"approval_url\": \"\",\r\n   \"transaction\": {\r\n      \"amount\": {\r\n         \"total\": \"7.47\",\r\n         \"currency\": \"USD\"\r\n      },\r\n      \"description\": null,\r\n      \"sale\": {\r\n         \"id\": \"\",\r\n         \"parent_id\": \"\"\r\n      },\r\n      \"authorization\": {\r\n         \"id\": \"\",\r\n         \"created\": \"\"\r\n      }\r\n   },\r\n   \"error\": {\r\n      \"code\": false\r\n   }\r\n}\r\n```\r\n\r\n#### Void an Authorization\r\nThere are all sorts of reasons one would void an authorization (client canceled the transaction, some other reason that would mean you shoudln't be charging them, whatever).\r\n\r\nTo void an authorization one must create the [Authorization](#credit-card-payment) (Credit Card Payment with $type set to `authorization`) and get the Authorization ID from the response.\r\n\r\nHere's an example of voiding an authorization:\r\n\r\n```\r\n$data = array(\r\n\t'authorization_id' => '2073151243457584H'\r\n);\r\n\r\n$response = $this->Paypal->voidAuthorization($data);\r\n```\r\n* `authorization_id` is stored in the response object returned by `Paypal::creditCardPayment()` in `$response->transaction->authorization->id`\r\n\r\n##### Example Response\r\n```\r\n{\r\n   \"id\": \"2073151243457584H\",\r\n   \"status\": \"voided\",\r\n   \"created\": \"2014-01-12 14:36:48\",\r\n   \"modified\": \"2014-01-12 14:37:00\",\r\n   \"payment_method\": null,\r\n   \"type\": null,\r\n   \"payer\": {\r\n      \"billing_address\": {\r\n         \"line1\": \"\",\r\n         \"line2\": \"\",\r\n         \"city\": \"\",\r\n         \"country_code\": \"\",\r\n         \"postal_code\": \"\",\r\n         \"state\": \"\"\r\n      },\r\n      \"credit_card\": {\r\n         \"number\": \"\",\r\n         \"type\": \"\",\r\n         \"expire_month\": \"\",\r\n         \"expire_year\": \"\",\r\n         \"first_name\": \"\",\r\n         \"last_name\": \"\"\r\n      },\r\n      \"id\": \"\",\r\n      \"email\": \"\"\r\n   },\r\n   \"approval_url\": \"\",\r\n   \"transaction\": {\r\n      \"amount\": {\r\n         \"total\": \"7.47\",\r\n         \"currency\": \"USD\",\r\n         \"details\": {\r\n            \"subtotal\": \"7.41\",\r\n            \"tax\": \"0.03\",\r\n            \"shipping\": \"0.03\"\r\n         }\r\n      },\r\n      \"description\": null,\r\n      \"sale\": {\r\n         \"id\": \"\",\r\n         \"parent_id\": \"\"\r\n      },\r\n      \"authorization\": {\r\n         \"id\": \"\",\r\n         \"created\": \"\"\r\n      }\r\n   },\r\n   \"error\": {\r\n      \"code\": false\r\n   }\r\n}\r\n```\r\n\r\n#### Refund a sale\r\n\r\nSometimes it's necessary to refund a transaction.\r\nTo refund a sale one must first create the [Sale](#credit-card-payment) (Credit Card Payment with $type set to `sale`) and get the Sale ID from the response.\r\n\r\n```\r\n$data = array(\r\n\t'payment_id' => '3XX41928KR179661L',\r\n\t'currency'   => 'USD',\r\n\t'total'      => '7.47'\r\n);\r\n\r\n$response = $this->Paypal->refundPayment($data);\r\n```\r\n* `payment_id` is stored in the response object returned by `Paypal::creditCardPayment()` in `$response->transaction->sale->id`\r\n\r\n##### Example Response\r\n```\r\n{\r\n   \"id\": \"7FN74449PP796325P\",\r\n   \"status\": \"completed\",\r\n   \"created\": \"2014-01-13 16:31:24\",\r\n   \"modified\": \"2014-01-13 16:31:24\",\r\n   \"payment_method\": null,\r\n   \"type\": \"refund\",\r\n   \"payer\": {\r\n      \"billing_address\": {\r\n         \"line1\": \"\",\r\n         \"line2\": \"\",\r\n         \"city\": \"\",\r\n         \"country_code\": \"\",\r\n         \"postal_code\": \"\",\r\n         \"state\": \"\"\r\n      },\r\n      \"credit_card\": {\r\n         \"number\": \"\",\r\n         \"type\": \"\",\r\n         \"expire_month\": \"\",\r\n         \"expire_year\": \"\",\r\n         \"first_name\": \"\",\r\n         \"last_name\": \"\"\r\n      },\r\n      \"id\": \"\",\r\n      \"email\": \"\"\r\n   },\r\n   \"approval_url\": \"\",\r\n   \"transaction\": {\r\n      \"amount\": {\r\n         \"total\": \"7.47\",\r\n         \"currency\": \"USD\"\r\n      },\r\n      \"description\": null,\r\n      \"sale\": {\r\n         \"id\": \"\",\r\n         \"parent_id\": \"\"\r\n      },\r\n      \"authorization\": {\r\n         \"id\": \"\",\r\n         \"created\": \"\"\r\n      }\r\n   },\r\n   \"error\": {\r\n      \"code\": false\r\n   }\r\n}\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}